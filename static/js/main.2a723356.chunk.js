(this["webpackJsonpnote-bulks"]=this["webpackJsonpnote-bulks"]||[]).push([[0],{167:function(e,t,n){"use strict";n.r(t);var i=n(2),o=n.n(i),r=n(23),c=n.n(r),a=(n(95),n(1)),s=n.n(a),d=n(6),l=n(17),u=n(32),b=n(18),j=n(24),f=n(14);function p(){var e=Object(i.useState)(null),t=Object(l.a)(e,2),n=t[0],o=t[1];function r(){return(r=Object(d.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(f.i)(Object(f.c)(window.db,"topic")),n=Object(f.h)(t,(function(e){var t=[];e.forEach((function(e){t.push(Object(j.a)({id:e.id},e.data()))})),o(t.sort((function(e,t){return t.priority-e.priority})))})),e.abrupt("return",(function(){return n()}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){return function(){return r.apply(this,arguments)}()}),[]),{topic:n}}var h=n(30),O=(n(98),function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t});var g=n(8),x=Object(u.a)({root:function(e){return{display:"flex",alignItems:"center",justifyContent:"center",width:18,height:18,border:[2,e.color,"solid"],borderRadius:5,cursor:"default"}},fill:function(e){return{width:10,height:10,backgroundColor:e.color,borderRadius:3}}});function w(e){var t=e.color,n=e.value,i=e.onChange,o=x({color:t});return Object(g.jsx)("span",{className:o.root,onClick:function(){return i(!n)},children:n&&Object(g.jsx)("div",{className:o.fill})})}var v=n(47),m=n.n(v),y=Object(u.a)({root:{display:"flex",alignItems:"center",padding:[5,10],fontSize:16,"& > div":{display:"flex",flexGrow:1},"& .remove":{opacity:0,transition:".3s"},"&:hover":{"& .remove":{opacity:1}}},input:function(e){var t=e.isEditing;return{position:t?"relative":"absolute",opacity:t?1:0,pointerEvents:t?"auto":"none",outline:"none",flexGrow:1,fontSize:16}},text:function(e){var t=e.isEditing;return{display:"inline-block",height:25,position:t?"absolute":"relative",opacity:t?0:1,pointerEvents:t?"none":"auto",flexGrow:1,fontSize:18,textDecoration:e.finished?"line-through":"none"}}}),k=Object(i.forwardRef)((function(e,t){var n=e.todo,o=e.color,r=e.provided,c=e.snapshot,a=e.remove,u=Object(i.useRef)(null),p=Object(i.useRef)(null),h=Object(i.useState)(!1),O=Object(l.a)(h,2),x=O[0],v=O[1],k=y({isEditing:x,finished:n.finished}),C=Object(i.useState)(""),S=Object(l.a)(C,2),N=S[0],E=S[1],I=Object(i.useState)(!1),z=Object(l.a)(I,2),R=(z[0],z[1]);function D(){if(x){var e=Object(f.d)(window.db,"todo",n.id);Object(f.j)(e,{text:N}),v(!1)}}function P(e){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(s.a.mark((function e(t){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(f.d)(window.db,"todo",n.id),e.next=3,Object(f.j)(i,{finished:t});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(i.useEffect)((function(){n&&(E(n.text),R(n.finished))}),[n]);return Object(g.jsxs)("div",Object(j.a)(Object(j.a)(Object(j.a)({className:k.root,ref:t},r.draggableProps),r.dragHandleProps),{},{children:[Object(g.jsx)(w,{color:o,value:n.finished,onChange:function(e){R(e),P(e)}}),Object(g.jsx)("span",{style:{width:10}}),Object(g.jsxs)(m.a,{onOutsideClick:function(){return D()},children:[Object(g.jsx)("input",{ref:p,className:k.input,value:N,onKeyDown:function(e){"Enter"===e.key&&D()},onChange:function(e){return E(e.target.value)}}),Object(g.jsx)("span",{className:k.text,onClick:function(){null!==u.current?(v(!0),p.current.focus(),p.current.select(),clearTimeout(u.current),u.current=null):u.current=setTimeout((function(){u.current=null,c.isDragging||(R(!n.finished),P(!n.finished))}),200)},children:N}),Object(g.jsx)(b.q,{className:"remove",size:20,color:o,onClick:function(){a(n.id)}})]})]}))})),C=(n(121),n(48)),S=n.n(C),N={work:Object(g.jsx)(b.u,{}),book:Object(g.jsx)(b.e,{}),person:Object(g.jsx)(b.p,{}),star:Object(g.jsx)(b.r,{}),money:Object(g.jsx)(b.d,{}),game:Object(g.jsx)(b.t,{}),mark:Object(g.jsx)(b.n,{}),event:Object(g.jsx)(b.j,{}),cart:Object(g.jsx)(b.m,{}),bus:Object(g.jsx)(b.i,{}),bug:Object(g.jsx)(b.f,{}),archive:Object(g.jsx)(b.c,{}),alarm:Object(g.jsx)(b.b,{}),cam:Object(g.jsx)(b.s,{})};var E=n(72),I=n(60);function z(){var e=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t,n,i="#";for(n=0;n<3;n++)t=parseInt(e.substr(2*n,2),16),i+=("00"+(t=Math.round(Math.min(Math.max(0,t+-.25*t),255)).toString(16))).substr(t.length);return i}var R=n(83),D=n.n(R),P=(n(122),Object(u.a)({root:{backgroundColor:"white",boxShadow:[0,0,5,0,"gray"],borderRadius:5,margin:[20,0]},header:function(e){return{position:"relative",display:"flex",alignItems:"center",backgroundColor:e.color,borderRadius:[5,5,0,0],padding:[10,10],color:"white",fontWeight:500,fontSize:18,transition:".3s"}},input:function(e){var t=e.isEditing;return{position:t?"relative":"absolute",opacity:t?1:0,pointerEvents:t?"auto":"none",outline:"none",flexGrow:1,fontSize:18}},title:function(e){var t=e.isEditing;return{display:"inline-block",height:25,position:t?"absolute":"relative",opacity:t?0:1,pointerEvents:t?"none":"auto",flexGrow:1,fontSize:20,cursor:"default",textDecoration:e.finished?"line-through":"none",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},list:{padding:[5,0]},footer:{position:"relative",display:"flex",padding:[5,10],fontSize:14,justifyContent:"space-between"},status:{cursor:"pointer",display:"inline-block",backgroundColor:"white",borderRadius:100,padding:[2,10],transition:".3s","&:hover":{filter:"brightness(0.9)"}},priority:function(e){return{display:"inline-block",backgroundColor:["green","#f7be2d","red"][e.priority],width:10,height:10,margin:[0,5,0,0],borderRadius:100}},process:function(e){var t=e.color,n=e.process;return{overflow:"hidden",borderRadius:[0,0,5,5],"& div":{backgroundColor:t,width:"".concat(n,"%"),height:5,transition:".5s"}}},button:function(e){var t=e.color;return{cursor:"pointer",width:25,height:25,display:"inline-flex",padding:1,alignItems:"center",borderRadius:100,justifyContent:"center",backgroundColor:t,transition:".3s",flexShrink:0,"& svg":{color:"white",transition:".3s"},"&:hover":{backgroundColor:"white","& svg":{color:t},"& svg.rotate":{transform:"rotate(180deg)"}}}},menu:{position:"absolute",padding:10,width:200,backgroundColor:"white",top:"calc(100% + 10px)",boxShadow:[0,0,5,2,"gray"],zIndex:10,borderRadius:10,transition:".3s"},iconSelect:{cursor:"pointer",width:25,height:25,display:"inline-flex",padding:4,alignItems:"center",borderRadius:100,justifyContent:"center",transition:".3s"},item:function(e){var t=e.color;return{padding:5,display:"flex",alignItems:"center",color:t,backgroundColor:"white","&:hover":{color:"white",backgroundColor:t},userSelect:"none"}},selectPriority:{display:"flex",justifyContent:"center",alignItems:"center"},invertButton:function(e){var t=e.color;return{cursor:"pointer",width:25,height:25,margin:[0,10],display:"inline-flex",padding:1,alignItems:"center",borderRadius:100,justifyContent:"center",backgroundColor:"white",transition:".3s",flexShrink:0,"& svg":{color:t,transition:".3s"},"&:hover":{backgroundColor:t,"& svg":{color:"white"}}}},dataPicker:function(e){return{boxSizing:"border-size",margin:[10,0],padding:[5,10],width:"100%",borderRadius:100,outline:"none",border:[2,"solid",e.color]}},dataPickerClear:function(e){return{"&::after":{backgroundColor:e.color+" !important"}}}})),M=Object(i.forwardRef)((function(e,t){var n,o=e.topic,r=Object(i.useState)(!1),c=Object(l.a)(r,2),a=c[0],u=c[1],p=Object(i.useRef)(null),x=Object(i.useState)(""),w=Object(l.a)(x,2),v=w[0],y=w[1],C=Object(i.useState)([]),R=Object(l.a)(C,2),M=R[0],B=R[1],F=Object(i.useState)(!1),G=Object(l.a)(F,2),T=G[0],X=G[1],A=Object(i.useState)(!1),J=Object(l.a)(A,2),K=J[0],L=J[1],W=function(e,t){var n=Object(i.useState)([]),o=Object(l.a)(n,2),r=o[0],c=o[1],a=Object(i.useRef)(null);function u(){return b.apply(this,arguments)}function b(){return(b=Object(d.a)(s.a.mark((function n(){var i,o,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=Object(f.i)(Object(f.c)(window.db,"todo"),Object(f.k)("tid","==",e)),n.next=3,Object(f.f)(i);case 3:o=n.sent,r=[],o.forEach((function(e){r[t.findIndex((function(t){return t===e.id}))]=Object(j.a)({id:e.id},e.data())})),c(r);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(i.useEffect)((function(){if(t){u();var n=Object(f.i)(Object(f.c)(window.db,"todo"),Object(f.k)("tid","==",e)),i=Object(f.h)(n,(function(e){console.log("onSnapshot"),e.docChanges().forEach((function(e){if("modified"===e.type){var n=Object(h.a)(a.current);n[t.findIndex((function(t){return t===e.doc.id}))]=Object(j.a)({id:e.doc.id},e.doc.data()),c(n)}}))}));return function(){i()}}}),[t]),Object(i.useEffect)((function(){a.current=r}),[r]),{todos:r,refresh:u}}(o.id,M).todos,Z=P({color:o.color,priority:o.priority,process:W?0===W.length?100:W.filter((function(e){return e.finished})).length/W.length*100:0,isEditing:a});function q(){if(a){var e=Object(f.d)(window.db,"topic",o.id);Object(f.j)(e,{title:v}),u(!1)}}function H(){return(H=Object(d.a)(s.a.mark((function e(){var t,n,i,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(f.l)(window.db),n=Object(f.d)(window.db,"todo",O(10)),t.set(n,{tid:o.id,text:"\u65b0\u9805\u76ee",finished:!1}),i=[].concat(Object(h.a)(o.list),[n.id]),B(i),r=Object(f.d)(window.db,"topic",o.id),t.update(r,{list:i}),e.next=9,t.commit();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return U.apply(this,arguments)}function U(){return(U=Object(d.a)(s.a.mark((function e(t){var n,i,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(f.l)(window.db),i=o.list.filter((function(e){return e!==t})),B(i),r=Object(f.d)(window.db,"topic",o.id),n.update(r,{list:i}),n.delete(Object(f.d)(window.db,"todo",t)),n.commit();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=Object(f.l)(window.db)).delete(Object(f.d)(window.db,"topic",o.id)),M.forEach((function(e){t.delete(Object(f.d)(window.db,"todo",e))})),t.commit();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(d.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(f.d)(window.db,"topic",o.id),Object(f.j)(n,{icon:t});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){var t=(o.priority+4+e)%4,n=Object(f.d)(window.db,"topic",o.id);Object(f.j)(n,{priority:t})}return Object(i.useEffect)((function(){o&&(y(o.title),B(o.list))}),[o]),W?Object(g.jsxs)("div",{className:Z.root,ref:t,children:[Object(g.jsx)(m.a,{onOutsideClick:function(){q(),X(!1)},display:"block",children:Object(g.jsxs)("div",{className:Z.header,children:[Object(g.jsx)("span",{className:Z.button,onClick:function(){return X(!0)},children:(n=o.icon,N[n])}),Object(g.jsxs)("div",{className:Z.menu,style:{color:o.color,opacity:T?1:0,pointerEvents:T?"auto":"none"},children:[Object(g.jsx)("div",{children:Object.keys(N).map((function(e){return Object(g.jsx)("span",{className:Z.iconSelect,style:{background:o.icon===e&&o.color},onClick:function(){return function(e){return Y.apply(this,arguments)}(e)},children:Object(i.cloneElement)(N[e],{size:20,color:o.icon===e?"white":""})},e)}))}),Object(g.jsx)("hr",{}),Object(g.jsxs)("div",{className:Z.item,onClick:function(){return V.apply(this,arguments)},children:[Object(g.jsx)(b.h,{})," \u522a\u9664"]}),Object(g.jsxs)("div",{className:Z.item,onClick:function(){var e=Object(f.d)(window.db,"topic",o.id);Object(f.j)(e,{color:z()})},children:[Object(g.jsx)(b.o,{})," \u66f4\u63db\u984f\u8272"]})]}),Object(g.jsx)("span",{style:{width:5}}),Object(g.jsx)("div",{className:Z.title,onDoubleClick:function(){u(!0),p.current.focus(),p.current.select()},children:v}),Object(g.jsx)("input",{ref:p,className:Z.input,value:v,onKeyDown:function(e){"Enter"===e.key&&q()},onChange:function(e){return y(e.target.value)}}),Object(g.jsx)("span",{className:Z.button,children:Object(g.jsx)(b.a,{className:"rotate",onClick:function(){return H.apply(this,arguments)}})})]})}),Object(g.jsx)(I.a,{onDragEnd:function(e){if(e.destination){var t=Array.from(o.list),n=t.splice(e.source.index,1),i=Object(l.a)(n,1)[0];t.splice(e.destination.index,0,i),B(t);var r=Object(f.d)(window.db,"topic",o.id);Object(f.j)(r,{list:t})}},children:Object(g.jsx)(I.c,{droppableId:"droppable",children:function(e,t){return Object(g.jsxs)("div",Object(j.a)(Object(j.a)({},e.droppableProps),{},{ref:e.innerRef,className:Z.list,children:[W.map((function(e,t){return Object(g.jsx)(I.b,{draggableId:e.id,index:t,children:function(t,n){return Object(g.jsx)(k,{ref:t.innerRef,todo:e,color:o.color,provided:t,snapshot:n,remove:Q},e.id)}},e.id)})),e.placeholder]}))}})}),Object(g.jsx)(m.a,{onOutsideClick:function(){L(!1)},display:"block",children:Object(g.jsxs)("div",{className:Z.footer,children:[Object(g.jsxs)("span",{style:{color:o.color,fontWeight:500},children:[0===W.length?0:Math.round(W.filter((function(e){return e.finished})).length/W.length*100),"%"]}),Object(g.jsxs)("span",{className:Z.status,onClick:function(){return L(!0)},children:[3===o.priority?Object(g.jsx)(E.a,{color:o.color,style:{marginRight:5}}):Object(g.jsx)("span",{className:Z.priority}),o.deadline?S()(o.deadline.toDate()).isBefore(S()())?Object(g.jsx)("span",{style:{color:"red"},children:"\u5df2\u904e\u671f"}):S()(o.deadline.toDate()).local("zh-tw").fromNow():"\u7121\u6642\u9650"]}),Object(g.jsxs)("div",{className:Z.menu,style:{right:0,color:o.color,opacity:K?1:0,pointerEvents:K?"auto":"none"},children:[Object(g.jsxs)("div",{className:Z.selectPriority,children:[Object(g.jsx)("span",{className:Z.invertButton,onClick:function(){return _(-1)},children:Object(g.jsx)(b.k,{size:25})}),3===o.priority?Object(g.jsx)(E.a,{color:o.color}):Object(g.jsx)("span",{className:Z.priority}),Object(g.jsx)("span",{style:{color:["green","#f7be2d","red"][o.priority]},children:3===o.priority?"\u91d8\u9078":["\u4f4e","\u4e2d","\u9ad8"][o.priority]}),Object(g.jsx)("span",{className:Z.invertButton,onClick:function(){return _(1)},children:Object(g.jsx)(b.l,{size:25})})]}),console.log(o.deadline),Object(g.jsx)(D.a,{className:Z.dataPicker,selected:o.deadline?o.deadline.toDate():null,onChange:function(e){console.log("date",e);var t=Object(f.d)(window.db,"topic",o.id);Object(f.j)(t,{deadline:e})},dateFormat:"yyyy/MM/dd",isClearable:!0,placeholderText:"\u7121\u6642\u9650",clearButtonClassName:Z.dataPickerClear})]})]})}),Object(g.jsx)("div",{className:Z.process,children:Object(g.jsx)("div",{})})]}):Object(g.jsx)(g.Fragment,{})})),B=n(86),F=Object(u.a)({root:function(e){return{height:"100vh",width:350,background:"url(./background.jpg)",backgroundColor:"rgba(255, 255, 255, 0.61)",zIndex:0,backgroundSize:"cover",backgroundPositionX:"50%",transition:".3s",transform:e.show?"translateX(0)":"translateX(400px)"}},commandInput:{display:"flex",alignItems:"center",width:350,backgroundColor:"white",padding:[10,10],"& input":{flexGrow:1,padding:5,fontSize:16,border:"none",outline:"none"}},list:{padding:[0,10]},addButton:{cursor:"pointer",width:40,height:40,display:"inline-flex",alignItems:"center",borderRadius:100,justifyContent:"center",backgroundColor:"white",transition:".3s","& svg":{color:"#222",transition:".3s"},"&:hover":{backgroundColor:"#222","& svg":{color:"white",transform:"rotate(180deg)"}}}});var G=function(){var e=Object(i.useState)(""),t=Object(l.a)(e,2),n=t[0],o=t[1],r=Object(i.useState)(!1),c=Object(l.a)(r,2),a=c[0],u=c[1],j=F({show:a}),h=p().topic;function O(){return(O=Object(d.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.b)(Object(f.c)(window.db,"topic"),{color:z(),deadline:null,icon:"person",list:[],priority:0,title:"\u65b0\u4e3b\u984c"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){var e=new WebSocket("ws://localhost:4141");e.onmessage=function(e){"show"===e.data?u(!0):"hidden"===e.data&&u(!1)},e.onopen=function(){return console.log("open")}}),[]),Object(g.jsxs)("div",{className:j.root,children:[Object(g.jsxs)("div",{className:j.commandInput,children:[Object(g.jsx)(b.g,{size:24}),Object(g.jsx)("input",{value:n,onChange:function(e){return o(e.target.value)}}),Object(g.jsx)("span",{className:j.addButton,onClick:function(){return O.apply(this,arguments)},children:Object(g.jsx)(b.a,{size:24})})]}),Object(g.jsx)("div",{className:j.list,children:h&&Object(g.jsx)(B.a,{children:h.map((function(e){return Object(g.jsx)(M,{topic:e},e.id)}))})})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,174)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),o(e),r(e),c(e)}))},X=n(87);window.firebase=Object(X.a)({apiKey:"AIzaSyAZQRdlE7NZ7Tws_sPkMyll8-dzVoj9kyE",authDomain:"coherent-ascent-311605.firebaseapp.com",projectId:"coherent-ascent-311605",storageBucket:"coherent-ascent-311605.appspot.com",messagingSenderId:"148310881329",appId:"1:148310881329:web:6b2cccf07a7ca0d7839110",measurementId:"G-L8XMFDZTJX"}),window.db=Object(f.g)(window.firebase,{cacheSizeBytes:f.a}),Object(f.e)(window.db).catch((function(e){if("failed-precondition"===e.code)throw new Error("failed-precondition");if("unimplemented"===e.code)throw new Error("unimplemented")})),c.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(G,{})}),document.getElementById("root")),T()},95:function(e,t,n){}},[[167,1,2]]]);
//# sourceMappingURL=main.2a723356.chunk.js.map